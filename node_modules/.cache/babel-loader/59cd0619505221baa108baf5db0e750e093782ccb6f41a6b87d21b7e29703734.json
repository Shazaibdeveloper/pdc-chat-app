{"ast":null,"code":"var _jsxFileName = \"E:\\\\React Js\\\\react-firebase-chat-app-main\\\\react-firebase-chat-app-main\\\\src\\\\components\\\\Auth.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { auth, RecaptchaVerifier } from \"../firebase-config\";\nimport { signInWithPhoneNumber, updateProfile } from \"firebase/auth\";\nimport Cookies from \"universal-cookie\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst cookies = new Cookies();\nexport const Auth = _ref => {\n  _s();\n  let {\n    setIsAuth\n  } = _ref;\n  const [phone, setPhone] = useState(\"\");\n  const [code, setCode] = useState(\"\");\n  const [userName, setUserName] = useState(\"\");\n  const [confirmResult, setConfirmResult] = useState(null);\n  const setupRecaptcha = () => {\n    window.recaptchaVerifier = new RecaptchaVerifier(\"recaptcha-container\", {\n      size: \"invisible\",\n      callback: response => {\n        // reCAPTCHA solved\n      }\n    }, auth);\n  };\n  const handleSendCode = async () => {\n    if (phone.length !== 10 || !/^\\d{10}$/.test(phone)) {\n      alert(\"Please enter a valid 10-digit Pakistani number without +92\");\n      return;\n    }\n    const fullPhone = `+92${phone}`;\n    setupRecaptcha();\n    const appVerifier = window.recaptchaVerifier;\n    try {\n      const confirmationResult = await signInWithPhoneNumber(auth, fullPhone, appVerifier);\n      setConfirmResult(confirmationResult);\n      alert(\"OTP sent!\");\n    } catch (error) {\n      console.error(\"SMS not sent\", error);\n    }\n  };\n  const handleVerifyCode = async () => {\n    try {\n      const result = await confirmResult.confirm(code);\n      if (userName) {\n        await updateProfile(result.user, {\n          displayName: userName\n        });\n      }\n      cookies.set(\"auth-token\", result.user.refreshToken);\n      setIsAuth(true);\n    } catch (error) {\n      console.error(\"Code verification failed\", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"auth\",\n    children: !confirmResult ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          gap: \"5px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            padding: \"10px\",\n            border: \"1px solid #ccc\",\n            borderRadius: \"5px 0 0 5px\",\n            background: \"#f0f0f0\"\n          },\n          children: \"+92\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          maxLength: \"10\",\n          pattern: \"\\\\d*\",\n          placeholder: \"Enter 10-digit number\",\n          value: phone,\n          onChange: e => {\n            const value = e.target.value.replace(/\\D/g, \"\");\n            setPhone(value);\n          },\n          style: {\n            flex: 1,\n            border: \"1px solid #ccc\",\n            borderRadius: \"0 5px 5px 0\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Enter your name (optional)\",\n        value: userName,\n        onChange: e => setUserName(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"recaptcha-container\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSendCode,\n        children: \"Send OTP\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Enter OTP\",\n        value: code,\n        onChange: e => setCode(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleVerifyCode,\n        children: \"Verify OTP\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n_s(Auth, \"4Y0yMQAa5bXlWsH7x/8mlWndMV4=\");\n_c = Auth;\nvar _c;\n$RefreshReg$(_c, \"Auth\");","map":{"version":3,"names":["React","useState","auth","RecaptchaVerifier","signInWithPhoneNumber","updateProfile","Cookies","cookies","Auth","setIsAuth","phone","setPhone","code","setCode","userName","setUserName","confirmResult","setConfirmResult","setupRecaptcha","window","recaptchaVerifier","size","callback","response","handleSendCode","length","test","alert","fullPhone","appVerifier","confirmationResult","error","console","handleVerifyCode","result","confirm","user","displayName","set","refreshToken","display","gap","padding","border","borderRadius","background","e","value","target","replace","flex"],"sources":["E:/React Js/react-firebase-chat-app-main/react-firebase-chat-app-main/src/components/Auth.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { auth, RecaptchaVerifier } from \"../firebase-config\";\nimport {\n  signInWithPhoneNumber,\n  updateProfile,\n} from \"firebase/auth\";\nimport Cookies from \"universal-cookie\";\n\nconst cookies = new Cookies();\n\nexport const Auth = ({ setIsAuth }) => {\n  const [phone, setPhone] = useState(\"\");\n  const [code, setCode] = useState(\"\");\n  const [userName, setUserName] = useState(\"\");\n  const [confirmResult, setConfirmResult] = useState(null);\n\n  const setupRecaptcha = () => {\n    window.recaptchaVerifier = new RecaptchaVerifier(\n      \"recaptcha-container\",\n      {\n        size: \"invisible\",\n        callback: (response) => {\n          // reCAPTCHA solved\n        },\n      },\n      auth\n    );\n  };\n\n  const handleSendCode = async () => {\n    if (phone.length !== 10 || !/^\\d{10}$/.test(phone)) {\n      alert(\"Please enter a valid 10-digit Pakistani number without +92\");\n      return;\n    }\n\n    const fullPhone = `+92${phone}`;\n    setupRecaptcha();\n    const appVerifier = window.recaptchaVerifier;\n\n    try {\n      const confirmationResult = await signInWithPhoneNumber(\n        auth,\n        fullPhone,\n        appVerifier\n      );\n      setConfirmResult(confirmationResult);\n      alert(\"OTP sent!\");\n    } catch (error) {\n      console.error(\"SMS not sent\", error);\n    }\n  };\n\n  const handleVerifyCode = async () => {\n    try {\n      const result = await confirmResult.confirm(code);\n      if (userName) {\n        await updateProfile(result.user, {\n          displayName: userName,\n        });\n      }\n      cookies.set(\"auth-token\", result.user.refreshToken);\n      setIsAuth(true);\n    } catch (error) {\n      console.error(\"Code verification failed\", error);\n    }\n  };\n\n  return (\n    <div className=\"auth\">\n      {!confirmResult ? (\n        <>\n          <div style={{ display: \"flex\", gap: \"5px\" }}>\n            <span style={{ padding: \"10px\", border: \"1px solid #ccc\", borderRadius: \"5px 0 0 5px\", background: \"#f0f0f0\" }}>+92</span>\n            <input\n              type=\"text\"\n              maxLength=\"10\"\n              pattern=\"\\d*\"\n              placeholder=\"Enter 10-digit number\"\n              value={phone}\n              onChange={(e) => {\n                const value = e.target.value.replace(/\\D/g, \"\");\n                setPhone(value);\n              }}\n              style={{\n                flex: 1,\n                border: \"1px solid #ccc\",\n                borderRadius: \"0 5px 5px 0\",\n              }}\n            />\n          </div>\n\n          <input\n            type=\"text\"\n            placeholder=\"Enter your name (optional)\"\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n          />\n          <div id=\"recaptcha-container\"></div>\n          <button onClick={handleSendCode}>Send OTP</button>\n        </>\n      ) : (\n        <>\n          <input\n            type=\"text\"\n            placeholder=\"Enter OTP\"\n            value={code}\n            onChange={(e) => setCode(e.target.value)}\n          />\n          <button onClick={handleVerifyCode}>Verify OTP</button>\n        </>\n      )}\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}